name: pre-bash-guard
description: 위험한 Bash 명령어 차단
event: PreToolUse
matcher: "Bash"
hooks:
  - type: command
    command: "${SKILL_DIR}/scripts/guard-bash.sh"

script_template: |
  #!/bin/bash
  # Block dangerous bash commands (PreToolUse hook)
  INPUT=$(cat)
  COMMAND=$(echo "$INPUT" | jq -r '.tool_input.command // empty')

  # Dangerous patterns - block if matched
  if echo "$COMMAND" | grep -qE 'rm\s+-rf\s+/|rm\s+-rf\s+~|--force|--no-verify'; then
    # PreToolUse requires JSON to stdout for blocking
    echo '{"decision": "block", "reason": "Dangerous command blocked: contains rm -rf or force flags"}'
    exit 2
  fi

  # Allow command
  exit 0
