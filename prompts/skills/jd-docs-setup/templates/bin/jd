#!/bin/bash
# jd - Johnny.Decimal 문서 관리 CLI
set -euo pipefail

JD_DIR="${JD_DIR:-$(dirname "$0")/jd.d}"
cmd="${1:-help}"
shift 2>/dev/null || true

if [[ "$cmd" == "help" || "$cmd" == "--help" || "$cmd" == "-h" ]]; then
  echo "jd - Johnny.Decimal 문서 관리"
  echo ""
  echo "Usage: jd <command> [args]"
  echo ""
  echo "Commands:"
  for f in "$JD_DIR"/*; do
    [[ -x "$f" ]] && echo "  $(basename "$f")"
  done
  echo ""
  echo "Examples:"
  echo "  jd new adr \"Database Selection\""
  echo "  jd index update"
  echo "  jd health --fix"
  exit 0
fi

subcmd="$JD_DIR/$cmd"
if [[ -x "$subcmd" ]]; then
  exec "$subcmd" "$@"
else
  echo "Unknown command: $cmd" >&2
  echo "Run 'jd help' for available commands" >&2
  exit 1
fi
