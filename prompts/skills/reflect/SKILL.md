---
name: reflect
description: 방향 수정 신호 감지 시 이전 단계 점검. Hook에서 "아니", "잠깐", "근데" 감지 시 자동 트리거.
---

# Reflect

사용자의 방향 수정 신호를 감지하고 이전 프로세스를 점검합니다.

## 트리거 조건

사용자 메시지가 다음 패턴으로 시작할 때:
- "아니" - 계획 거부, 범위 축소, 접근법 수정
- "잠깐" - 중단, 재검토 요청
- "근데" - 의문, 부가 조건, 전제 확인

## 5가지 근본 원인 체크리스트

감지 시 다음 원인을 순서대로 점검:

### 1. 컨텍스트 손실
- [ ] 이전 결정/상태를 잊었는가?
- [ ] 기존에 잘 동작하던 설정을 건드렸는가?
- [ ] 세션 초반 상태 확인을 생략했는가?

**맥락**: 이전 대화나 기존 상태에 대한 언급

### 2. 요구사항 불명확
- [ ] 범위 경계가 모호했는가?
- [ ] v1/v2, 지금/나중 구분이 없었는가?
- [ ] 최소 범위 요청을 확장했는가?

**맥락**: 범위 축소, 단계적 접근 요청

### 3. 설계 재검토 필요
- [ ] 구현 전 아키텍처 리뷰를 생략했는가?
- [ ] 폴더/패키지 구조를 검토하지 않았는가?
- [ ] 영향도 분석 없이 진행했는가?

**맥락**: 구조, 위치, 영향에 대한 질문

### 4. 범위 확장 금지 위반
- [ ] 요청받지 않은 필드/함수를 추가했는가?
- [ ] 사용자 확인 없이 기능을 확장했는가?
- [ ] 개선 의도로 요청 외 수정을 했는가?

**맥락**: 요청하지 않은 변경에 대한 지적

### 5. Chesterton's Fence 위반
- [ ] 기존 코드/설정의 이유를 파악하지 않고 수정했는가?
- [ ] "왜 이렇게 되어있는지" 확인했는가?
- [ ] 변경 전 역할 설명을 했는가?

**맥락**: 기존 동작/설정 보존 요청

## 분석 출력 형식

```
## Reflect 분석

**감지된 신호**: "{사용자 메시지 첫 부분}"
**추정 원인**: {1-5 중 해당 항목}

### 무엇이 잘못됐는가
- {구체적 문제점}

### 어떻게 예방할 수 있었는가
- {예방 방법}

### 권장 조치
- [ ] {즉시 할 일}
- [ ] {향후 규칙 추가 제안} (선택)
```

## 예방적 질문 (분석 후)

원인별 후속 질문:

| 원인 | 질문 |
|------|------|
| 컨텍스트 손실 | "현재 상태를 다시 확인할까요?" |
| 요구사항 불명확 | "이번에 구현할 범위를 명확히 해주세요" |
| 설계 재검토 | "구조를 먼저 제시해드릴까요?" |
| 범위 확장 | "다음만 구현합니다: [리스트]. 맞나요?" |
| Chesterton's Fence | "기존 설정의 역할을 먼저 파악하겠습니다" |

## 중요 원칙

1. **분석만, 자동 수정 없음**: 문제점과 개선안만 제시
2. **방어적 자세**: 사용자 신호를 무시하지 않음
3. **패턴 학습**: 동일 문제 2회 시 rules 추가 제안
4. **즉시 멈춤**: 분석 완료 전 다음 작업 진행 금지

## 연관 규칙

반복 발생 시 다음 규칙 추가 권장:
- `rules/no-scope-creep.md` - 범위 확장 금지
- `rules/chesterton-fence.md` - 수정 전 이유 파악
- `rules/confirm-before-implement.md` - 구현 전 확인
