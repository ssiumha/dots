---
name: reflect
description: 방향 수정 신호 감지 및 세션 전체 회고. "아니/잠깐/근데" 감지 시 자동 트리거, /reflect 또는 "회고해줘"로 세션 회고.
---

# Reflect

사용자의 방향 수정 신호를 감지하고 이전 프로세스를 점검합니다.

## 트리거 조건

### 실시간 방향 수정 (자동 감지)

사용자 메시지가 다음 패턴으로 시작할 때:
- "아니" - 계획 거부, 범위 축소, 접근법 수정
- "잠깐" - 중단, 재검토 요청
- "근데" - 의문, 부가 조건, 전제 확인

### 세션 전체 회고 (명시적 호출)

다음 키워드로 호출:
- `/reflect` - 슬래시 커맨드
- "회고해줘" - 자연어 요청
- "세션 회고" - 명시적 요청
- "오늘 작업 정리" - 작업 마무리 시

## 5가지 근본 원인 체크리스트

감지 시 다음 원인을 순서대로 점검:

### 1. 컨텍스트 손실
- [ ] 이전 결정/상태를 잊었는가?
- [ ] 기존에 잘 동작하던 설정을 건드렸는가?
- [ ] 세션 초반 상태 확인을 생략했는가?

**맥락**: 이전 대화나 기존 상태에 대한 언급

### 2. 요구사항 불명확
- [ ] 범위 경계가 모호했는가?
- [ ] v1/v2, 지금/나중 구분이 없었는가?
- [ ] 최소 범위 요청을 확장했는가?

**맥락**: 범위 축소, 단계적 접근 요청

### 3. 설계 재검토 필요
- [ ] 구현 전 아키텍처 리뷰를 생략했는가?
- [ ] 폴더/패키지 구조를 검토하지 않았는가?
- [ ] 영향도 분석 없이 진행했는가?

**맥락**: 구조, 위치, 영향에 대한 질문

### 4. 범위 확장 금지 위반
- [ ] 요청받지 않은 필드/함수를 추가했는가?
- [ ] 사용자 확인 없이 기능을 확장했는가?
- [ ] 개선 의도로 요청 외 수정을 했는가?

**맥락**: 요청하지 않은 변경에 대한 지적

### 5. Chesterton's Fence 위반
- [ ] 기존 코드/설정의 이유를 파악하지 않고 수정했는가?
- [ ] "왜 이렇게 되어있는지" 확인했는가?
- [ ] 변경 전 역할 설명을 했는가?

**맥락**: 기존 동작/설정 보존 요청

## 실시간 분석 출력 형식

```
## Reflect 분석

**감지된 신호**: "{사용자 메시지 첫 부분}"
**추정 원인**: {1-5 중 해당 항목}

### 무엇이 잘못됐는가
- {구체적 문제점}

### 어떻게 예방할 수 있었는가
- {예방 방법}

### 권장 조치
- [ ] {즉시 할 일}
- [ ] {향후 규칙 추가 제안} (선택)
```

## 세션 전체 회고 워크플로우

세션 종료 시 전체 작업을 돌아보고 개선점을 도출합니다.

### 분석 대상

1. **대화 히스토리**
   - 반복된 질문/수정 패턴
   - 삽질 구간 (같은 문제 재시도)
   - 비효율적 진행 (불필요한 탐색, 우회)

2. **코드 변경 사항**
   - `git diff` - 실제 변경 내용
   - `git status` - 변경된 파일 목록
   - 변경 범위와 복잡도

3. **사용된 도구/명령어**
   - 자주 사용된 도구 패턴
   - 실패한 명령어
   - 수동 반복 작업

### 개선 분석 영역

| 영역 | 분석 포인트 | 개선 예시 |
|------|------------|----------|
| **Skill** | 반복 패턴을 skill로 자동화 가능? | 새 skill 생성, 기존 skill 수정 |
| **Hook** | 실수 방지를 hook으로 자동화? | pre-commit, lint, format hook |
| **Scripts** | 수동 명령어를 스크립트화? | 빌드, 테스트, 배포 자동화 |
| **Rules** | 반복 실수를 규칙으로 방지? | rules/ 파일 추가 |
| **Agents** | 특정 작업을 agent로 위임? | agents/ 정의 추가 |
| **Pipeline** | 워크플로우 개선? | CI/CD, 작업 순서 최적화 |

### 세션 회고 출력 형식

```
## 세션 회고

### 작업 요약
- **수행한 작업**: {주요 작업 나열}
- **변경된 파일**: {파일 목록}
- **소요 시간대비 효율**: {높음/보통/낮음}

### 발견된 패턴

#### 잘한 점
- {효과적이었던 접근법}

#### 개선 필요
- {비효율적이었던 부분}
- {반복된 실수}

### 개선 제안

#### 즉시 적용 가능
- [ ] {구체적 개선안 + 적용 방법}

#### 검토 필요
- [ ] {추가 논의가 필요한 제안}

### 권장 후속 조치
- {skill/hook/rule 추가 제안}
- {문서화 필요 항목}
```

## 예방적 질문 (분석 후)

원인별 후속 질문:

| 원인 | 질문 |
|------|------|
| 컨텍스트 손실 | "현재 상태를 다시 확인할까요?" |
| 요구사항 불명확 | "이번에 구현할 범위를 명확히 해주세요" |
| 설계 재검토 | "구조를 먼저 제시해드릴까요?" |
| 범위 확장 | "다음만 구현합니다: [리스트]. 맞나요?" |
| Chesterton's Fence | "기존 설정의 역할을 먼저 파악하겠습니다" |

## 중요 원칙

1. **분석만, 자동 수정 없음**: 문제점과 개선안만 제시
2. **방어적 자세**: 사용자 신호를 무시하지 않음
3. **패턴 학습**: 동일 문제 2회 시 rules 추가 제안
4. **즉시 멈춤**: 분석 완료 전 다음 작업 진행 금지

## 연관 규칙

반복 발생 시 다음 규칙 추가 권장:
- `rules/no-scope-creep.md` - 범위 확장 금지
- `rules/chesterton-fence.md` - 수정 전 이유 파악
- `rules/confirm-before-implement.md` - 구현 전 확인
